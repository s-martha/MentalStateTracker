# MentalStateTracker
## bot.py
Запускаемый файл. Содержит непосредственно код работы с телеграмом
### Время отправки формы
Перед запуском бота все ранее записанные в бд времена сохраняются в словарь user_time.
При добавлении/изменении времени изменения фиксируются как в словаре, так и в бд
### Команды бота
- /start - запуск бота. При запуске пользователь должен выбрать время автоматической отправки формы.
- кнопка "Изменить время отправки формы" - изменить время автоматической отправки формы
- кнопка "Статистика за всё время" - получить статистику за всё время
- кнопка "Статистика за неделю" - получить статистику за последние 7 дней
- кнопка "Статистика за месяц" - получить статистику за последние 30 дней
- кнопка "Отправить форму" - получить форму не в установленное время

## База данных
### Таблица UsersMood.
Столбцы id, user_id, mood, makr_date
- id - integer, primary_key
- user_id - bigint - id пользователя
- mood - integer - настроение пользователя
- makr_date - date - дата добавления записи
### Таблица UsersTime
Столбцы id, user_id, mood, makr_date
- user_id - bigint - id пользователя
- form_time - time without time zone - время автоматическо отправки формы
- send_form - boolean - хочет ли пользователь получать форму автоматически
- send_weekly_stats - boolean - хочет ли пользователь получать статистику каждую неделю
## db.py
Функции, которые работают с бд. 
### AddMood(user_id, mood_value)
Cоздаёт новую запись в бд о настроении пользователя
### GetMoodDatesAndValues(user_id, period)
Возвращает (dates, values) для построения графика.
period - количество дней от текущей даты или "all_time", чтобы получить информацию за всё время
### AddUserTime(user_id, user_time)
Создаёт или изменяет запись о в бд о времени автоматической отправки формы
### GetAllUsersInfo(user_time, users_weekly_stats)
Заполняет словарь user_time[user_id] = form_time из бд
Заполняет сет users_weekly_stats id пользователей, которые получают статистику за неделю автоматически

## plot.py
ProtParse - функция, создающая график

## setting.py
Файл с настройками. В идеале предполагается, что это всё секретные штуки.
- TELEGRAM_BOT_TOKEN - токен телеграм-бота
- DATABASE_NAME - название бд
- DATABASE_USERNAME - username для доступа к бд
- DATABASE_PASSWORD - пароль для доступа к бд 
- DATABASE_HOST - хост, на котором расположена бд